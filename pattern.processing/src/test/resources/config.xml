<config>
   	<event id="RECEIVED" fileid="apollo">
	  <pattern id="receivedPing">PING RECEIVED: (\w+)</pattern>
  	</event>

  	<event id="SEND" fileid="apollo">
	  <pattern id="sendPing">HnSecEventManager.sendNotification\(\) MultiroomNotification\(MRCon,(\w+)\)</pattern>
  	</event>

  	
  	<event id="PATH_CHANGE" fileid="apollo">
	  <pattern id="pathChange">\[STATES_PATH_CHANGE\] source: (\w+), target: (\w+)</pattern>
  	</event>

	<event id="STATE_ACTIVATE" fileid="apollo">
	  <pattern id="activate">\[STATE_ACTIVATE\] (\w+)</pattern>
  	</event>

  	
	<action id="STATE_ACTIVATION" open="PATH_CHANGE" close="STATE_ACTIVATE">
	  <openactionhandler>
	    <![CDATA[
   		if (event.getProperty("pathChange$2") != null)
		{
			return Status.OPEN;
		}
		return null;
	    ]]>
	  </openactionhandler>
	  <closeactionhandler>
	    <![CDATA[
    		final Event openEvent = action.getEvent(Status.OPEN);
		if (openEvent.getProperty("pathChange$2").equals(event.getProperty("activate$1")))
		{
			action.setProperty("id", event.getProperty("activate$1"));
			if (event.getTimestamp() -  openEvent.getTimestamp()  < 60000)
			{
				return Status.CLOSE;	
			}
			else
			{
				return Status.TERMINATE;
			}
		}
		return null;
	    ]]>
	  </closeactionhandler>
	</action>

	  	
	<action id="CONNECTION_HEART_BEAT" open="SEND" close="RECEIVED">
	  <openactionhandler type="pl.com.itsense.analysis.event.log.handler.action.processing.ConnectionMonitor"/> 
	  <closeactionhandler type="pl.com.itsense.analysis.event.log.handler.action.processing.ConnectionMonitor"/>
	</action>

	
	<handler type="pl.com.itsense.analysis.event.log.handler.action.StatisticsCollector">
	  <property name="actions" value="CONNECTION_HEART_BEAT,STATE_ACTIVATION"/>
	</handler> 
	
	<report type="pl.com.itsense.analysis.event.log.reports.HTMLReport">
	  <property name="file" value="/home/ppretki/MyProjects/logs/report.html"/>
	  <property name="formatter" value="#.##"/>
	</report>
	
	<file id="apollo" path="/home/ppretki/MyProjects/logs/logfileAppolo.log"/>
   	
</config>